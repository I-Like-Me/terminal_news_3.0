After selecting a piece of text in the editor and clicking the link icon in the toolbar, the category dropdown appears and when a category is clicked it is replaced by the back arrow and the entry dropdown for the selected category. When i click on the entryDiv the text becomes unselected and nothing gets linked. How do i modify my code so the name of the item click on from the 'entryDiv' dropdown is stored in a variable called entryName, the name of the item clicked on from the 'categoryDiv' dropdown stored in a variable called categoryName, the 'entry.id' from the python code 'return {entry.id: entry.name for entry in entries}' is stored in a variable called entryID, and all three variables are sent in a json to the python route '@bp.route('/get_summary', methods=['GET'])' 

CSS:

@import url(https://fonts.googleapis.com/css?family=VT323);

html,
body {
    background: #383838;
    color: #00dd00;
    font-size: 64.5%;
    font-size: 1.4em;
    font-family: 'VT323', Courier;
    height: 100%;
    margin: 0;
    padding: 0;
    border: #ffffff;
    border-width: 1px;
}

#container {
    display: flex;
    height: 80vh;
    overflow: hidden;
    border: 5px solid #ddd; /* Add border to the container */
    padding: 0; /* Remove padding from the container */
  }
  
  #leftPanel {
    overflow-y: auto;
    border-right: 1px solid #ccc;
    white-space: nowrap; /* Prevent word wrapping in the left panel */
    padding: 10px 10px 10px 20px; /* Add padding to the left panel */
    width: 33%;
  }

  #rightPanel {
    overflow-y: auto;
    padding: 10px 20px 10px 10px; /* Add padding to the right panel */
    width: 67%;
    position: relative; /* Add this line */
  }
  
  #separator {
    cursor: ew-resize;
    background-color: #ddd;
    width: 10px;
    height: 100%;
    position: relative;
    flex-shrink: 0;
    border: none; /* Remove border from the separator */
  }


#editor {
  height: 100%;
  background-color: #383838;
  color: #00dd00;
  border: 2px solid #ffffff;
}

.ql-toolbar {
  background-color: #ffffff;
  overflow: visible;
}

.ql-snow .ql-picker {
    font-family: 'VT323', Courier;
    font-size: 24px !important;
    margin-left: 10px !important;
}

.ql-snow.ql-toolbar button:hover,
.ql-snow .ql-toolbar button:hover,
.ql-snow.ql-toolbar button:focus,
.ql-snow .ql-toolbar button:focus,
.ql-snow.ql-toolbar button.ql-active,
.ql-snow .ql-toolbar button.ql-active,
.ql-snow.ql-toolbar .ql-picker-label:hover,
.ql-snow .ql-toolbar .ql-picker-label:hover,
.ql-snow.ql-toolbar .ql-picker-label.ql-active,
.ql-snow .ql-toolbar .ql-picker-label.ql-active,
.ql-snow.ql-toolbar .ql-picker-item:hover,
.ql-snow .ql-toolbar .ql-picker-item:hover,
.ql-snow.ql-toolbar .ql-picker-item.ql-selected,
.ql-snow .ql-toolbar .ql-picker-item.ql-selected {
    color: #00dd00 !important;
    font-family: 'VT323', Courier;
}

.ql-snow.ql-toolbar button:hover .ql-fill,
.ql-snow .ql-toolbar button:hover .ql-fill,
.ql-snow.ql-toolbar button:focus .ql-fill,
.ql-snow .ql-toolbar button:focus .ql-fill,
.ql-snow.ql-toolbar button.ql-active .ql-fill,
.ql-snow .ql-toolbar button.ql-active .ql-fill,
.ql-snow.ql-toolbar .ql-picker-label:hover .ql-fill,
.ql-snow .ql-toolbar .ql-picker-label:hover .ql-fill,
.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-fill,
.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-fill,
.ql-snow.ql-toolbar .ql-picker-item:hover .ql-fill,
.ql-snow .ql-toolbar .ql-picker-item:hover .ql-fill,
.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-fill,
.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-fill,
.ql-snow.ql-toolbar button:hover .ql-stroke.ql-fill,
.ql-snow .ql-toolbar button:hover .ql-stroke.ql-fill,
.ql-snow.ql-toolbar button:focus .ql-stroke.ql-fill,
.ql-snow .ql-toolbar button:focus .ql-stroke.ql-fill,
.ql-snow.ql-toolbar button.ql-active .ql-stroke.ql-fill,
.ql-snow .ql-toolbar button.ql-active .ql-stroke.ql-fill,
.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,
.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,
.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,
.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,
.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,
.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,
.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill,
.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill {
  fill: #00dd00 !important;
  font-family: 'VT323', Courier;
}

.ql-snow.ql-toolbar button:hover .ql-stroke,
.ql-snow .ql-toolbar button:hover .ql-stroke,
.ql-snow.ql-toolbar button:focus .ql-stroke,
.ql-snow .ql-toolbar button:focus .ql-stroke,
.ql-snow.ql-toolbar button.ql-active .ql-stroke,
.ql-snow .ql-toolbar button.ql-active .ql-stroke,
.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke,
.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke,
.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke,
.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke,
.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke,
.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke,
.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke,
.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke,
.ql-snow.ql-toolbar button:hover .ql-stroke-miter,
.ql-snow .ql-toolbar button:hover .ql-stroke-miter,
.ql-snow.ql-toolbar button:focus .ql-stroke-miter,
.ql-snow .ql-toolbar button:focus .ql-stroke-miter,
.ql-snow.ql-toolbar button.ql-active .ql-stroke-miter,
.ql-snow .ql-toolbar button.ql-active .ql-stroke-miter,
.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke-miter,
.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke-miter,
.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,
.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,
.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke-miter,
.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke-miter,
.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter,
.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter {
  stroke: #00dd00 !important;
  font-family: 'VT323', Courier;
}

.ql-snow .ql-picker.ql-header .ql-picker-label::before {
  position: absolute;
}

.ql-editor {
  font-size: 2em;
  font-family: 'VT323', Courier;
}


.custom-dropdown {
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  max-height: 200px; /* Adjust as needed */
  overflow-y: auto;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
  border-radius: 0px;
  padding: 6px 8px;
  margin-top: 25px;
  display: block;
}

.custom-dropdown div {
  color: black;
  padding: 6px 8px;
  font-family: 'VT323', Courier;
  text-decoration: none;
}

.custom-drop-filter {
  height: 25px;
  width: 160px;
  position: absolute;
  font-family: 'VT323', Courier;
}

.custom-drop-buttons {
  position: absolute;
  top: 80px;
  right: 210px;
}

HTML:

<div id="container">
  <div id="leftPanel">
    <button id="toggleBtn" onclick="toggleFileTreeSearch()">Search</button>
    <div id="fileTreeContainer">
      <div id="fileTree" class="root-folder"></div>
    </div>
    <div id="searchContainer">
      <input type="text" id="searchInput" placeholder="Search..." onkeyup="handleKeyUp(event)">
      <button onclick="runSearch()">Search</button>
      <ul id="searchResults" onclick="handleSearchResultClick(event)"></ul>
    </div>
  </div>

  <div id="separator"></div>

  <div id="rightPanel">
    <div id="file_buttons" class="row" style="display: none;">
        <div class="column">
            <button id="saveBtn">Save</button>
            <button onclick="showInputField('move', event)">Move File</button>
            <button id="deleteBtn" style="background-color: red;" onclick="showInputField('delete_file', event)">Delete File</button>
        </div>
    </div>
    <div id="folder_buttons" class="row" style="display: none;">
        <div class="column">
            <button onclick="showInputField('folder', event)">Add Folder</button>
            <button onclick="showInputField('file', event)">Add File</button>
            <button onclick="showInputField('move', event)">Move Folder</button>
            <button style="background-color: red;" onclick="showInputField('delete_folder', event)">Delete Folder</button>
        </div>   
    </div>
    <div id="toolbar" style="display: none;">
      <div class="row"> 
        <div class="col">
          <!-- Add a series of dropdowns for headers -->
          <select class="ql-header">
            <option value="" selected></option>
            <option value="1">Header 1</option>
            <option value="2">Header 2</option>
            <option value="3">Header 3</option>
          </select>

          <!-- Add styling buttons -->
          <button class="ql-bold"></button>
          <button class="ql-italic"></button>
          <button class="ql-underline"></button>
      
          <!-- Add list buttons -->
          <button class="ql-list" value="ordered"></button>
          <button class="ql-list" value="bullet"></button>
      
          <!-- Add clean button -->
          <button class="ql-clean"></button>
          
          <!-- Add link button -->
          <button id='link-button' class="ql-link"></button>
        </div>
        <div class="col">
          <div id='linkDropdownDiv'></div>
        </div>
      </div>     
    </div>    
    <div id="editorContainer"></div> 
  </div>
</div>

JAVASCRIPT:
<script>
function displayTextInRightPanel(content, file_id) {
  const editorContainer = document.getElementById('editorContainer');
  editorContainer.innerHTML = '<div id="right_stuff"><div id="editor"></div></div>';
  var icons = Quill.import('ui/icons');

  var quill = new Quill('#editor', {
    modules: {
      toolbar: '#toolbar'
    },
    theme: 'snow'
  });


  let quillContent = document.querySelector('.ql-editor');
  quillContent.style.backgroundColor = '#383838';
  quillContent.style.color = '#00dd00';
  quillContent.style.borderColor = '#ffffff';
  quillContent.style.fontSize = '2em';

  let pickerElement = document.querySelector('.ql-snow .ql-picker:not(.ql-color-picker):not(.ql-icon-picker) svg'); 
  pickerElement.style.position = 'absolute';
  pickerElement.style.marginTop = '-10.5px';
  pickerElement.style.right = '85px';
  pickerElement.style.top = '36%';
  pickerElement.style.width = '30px';

  quill.clipboard.dangerouslyPasteHTML(content);
  
  const saveBtn = document.getElementById('saveBtn');

  saveBtn.addEventListener('click', function() {
    const editorContent = quill.root.innerHTML;

    fetch('/save_content', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ 
        content: editorContent,
        f_id: file_id
      })
    });
  });

  document.querySelector('#link-button').addEventListener('click', function() {
    if (document.getElementById("linkDropdownDiv")) {
      console.log('red');
    } else {
      console.log('blue');
    }

    let categorySearchInput = document.createElement('input');
    categorySearchInput.type = 'text';
    categorySearchInput.id = 'categorySearchInput';
    categorySearchInput.className = 'custom-drop-filter';
    categorySearchInput.placeholder = 'Category...';
    categorySearchInput.style.display = 'None';

    let linkDropdownDiv = document.querySelector('#linkDropdownDiv');
    linkDropdownDiv.appendChild(categorySearchInput);

    // Create a div for the categories
    let categoryDiv = document.createElement('div');
    categoryDiv.id = 'categoryDiv';
    categoryDiv.className = 'custom-dropdown'; 
    categoryDiv.style.display = 'none';

    // Create a search input field
    let entrySearchInput = document.createElement('input');
    entrySearchInput.type = 'text';
    entrySearchInput.id = 'entrySearchInput';
    entrySearchInput.className = 'custom-drop-filter';
    entrySearchInput.placeholder = 'Search...';
    entrySearchInput.style.display = 'none'; // Initially hidden

    // Create a left arrow icon
    let leftArrow = document.createElement('span');
    leftArrow.className = 'custom-drop-buttons';
    leftArrow.textContent = 'â†';
    leftArrow.style.display = 'none'; // Initially hidden

    // Append the left arrow and the search input field to your HTML
    linkDropdownDiv.appendChild(entrySearchInput);
    linkDropdownDiv.appendChild(leftArrow);
    

    // Create a div for the entries
    let entryDiv = document.createElement('div');
    entryDiv.id = 'entryDiv';
    entryDiv.className = 'custom-dropdown';
    entryDiv.style.display = 'none';

    
    // Append the div to your HTML
    linkDropdownDiv.appendChild(entryDiv);

    // Append the div to your HTML
    linkDropdownDiv.appendChild(categoryDiv);

    fetch('/get_categories')
      .then(response => response.json())
      .then(categories => {
        // Populate the div with the categories
        categoryDiv.innerHTML = ''; // Clear previous categories
        Object.keys(categories).forEach(categoryId => {
          let div = document.createElement('div');
          div.textContent = categories[categoryId];
          div.addEventListener('click', function() {
            console.log(div.innerHTML);
            // Replace the dropdown with the search input field
            categorySearchInput.style.display = 'none';
            categoryDiv.style.display = 'none';
            leftArrow.style.display = '';
            entrySearchInput.style.display = '';
            entryDiv.style.display = '';
            fetch('/get_category/' + div.innerHTML)
              .then(response => response.json())
              .then(data => {
                // Populate the div with the entries
                entryDiv.innerHTML = ''; // Clear previous entries
                Object.keys(data).forEach(entryId => {
                  let div = document.createElement('div');
                  div.textContent = data[entryId];
                  div.addEventListener('click', function() {
                    let range = quill.getSelection();
                    quill.insertText(range.index, div.textContent, {'link': '/entry/' + entryId});
                  });
                  entryDiv.appendChild(div);
                });
              });                
            });
            categoryDiv.appendChild(div);
          });
          categorySearchInput.style.display = '';
          categoryDiv.style.display = '';
        });

        // Add an event listener to the search field
        categorySearchInput.addEventListener('input', function() {
          let filter = categorySearchInput.value.toUpperCase();
          let divs = categoryDiv.getElementsByTagName('div');
          for (let i = 0; i < divs.length; i++) {
            let txtValue = divs[i].textContent;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
              divs[i].style.display = '';
            } else {
              divs[i].style.display = 'none';
            }
          }
        });

        // Add an event listener to the left arrow
        leftArrow.addEventListener('click', function() {
          // Replace the search input field with the dropdown
          categorySearchInput.style.display = '';
          categoryDiv.style.display = '';
          leftArrow.style.display = 'none';
          entrySearchInput.style.display = 'none';
          entryDiv.style.display = 'none'; // Hide the div
        });

        // Add an event listener to the search field
        entrySearchInput.addEventListener('input', function() {
          let filter = entrySearchInput.value.toUpperCase();
          let divs = entryDiv.getElementsByTagName('div');
          for (let i = 0; i < divs.length; i++) {
            let txtValue = divs[i].textContent;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
              divs[i].style.display = '';
            } else {
              divs[i].style.display = 'none';
            }
          }
          entryDiv.style.display = ''; // Show the div when typing
        });

  });

  quill.on('text-change', function(delta, oldDelta, source) {
    if (source == 'user') {
      let ops = delta.ops;
      ops.forEach(op => {
        if (op.insert && op.insert.link) {
          fetch(op.insert.link)
            .then(response => response.json())
            .then(data => alert(JSON.stringify(data)));
        }
      });
    }
  });  
}

Python:

@bp.route('/get_categories', methods=['GET'])
def get_categories():
    return {1: 'Ability', 2: 'Skill', 3: 'Damage Type'}

@bp.route('/get_category/<string:category>', methods=['GET'])
def get_category(category):
    print(category)
    if category == 'Ability':
        entries = Ability.query.all()
    elif category == 'Skill':
        entries = Skill.query.all()
    elif category == 'Damage Type':
        entries = Damagetype.query.all()
    print(entries)
    return {entry.id: entry.name for entry in entries}

@bp.route('/get_ability/<int:id>', methods=['GET'])
def get_ability(id):
    print(id)
    print('ability')
    ability = Ability.query.get(id)
    return {'name': ability.name}

@bp.route('/get_skill/<int:id>', methods=['GET'])
def get_skill(id):
    print(id)
    print('skill')
    skill = Skill.query.get(id)
    return {'name': skill.name}

@bp.route('/get_damage_type/<int:id>', methods=['GET'])
def get_damage_type(id):
    print(id)
    print('damage type')
    damagetype = Damagetype.query.get(id)
    return {'name': damagetype.name}

@bp.route('/get_summary', methods=['GET'])
def get_summary():
    data = request.get_json()
    print(data)